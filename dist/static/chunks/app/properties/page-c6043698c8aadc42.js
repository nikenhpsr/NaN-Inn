(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{314:function(e,s,t){Promise.resolve().then(t.bind(t,8053)),Promise.resolve().then(t.bind(t,3217)),Promise.resolve().then(t.bind(t,6852))},3217:function(e,s,t){"use strict";t.r(s);var l=t(1264),i=t(7288);s.default=e=>{let{title:s="No exact matches",subtitle:t="Reload the page"}=e;return(0,l.jsxs)("div",{className:"   h-[60vh]   flex    flex-col    gap-2    justify-center    items-center    ",children:[(0,l.jsx)(i.default,{center:!0,title:s,subtitle:t}),(0,l.jsx)("div",{className:"w-48 mt-4"})]})}},2852:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var l=t(1264),i=t(8096),r=t(5083),o=t(7094),a=t(6141),n=t(3451),c=t(1911),d=e=>{let{listingId:s,currentUser:t}=e,l=(0,o.useRouter)(),i=(0,c.Z)(),d=(0,a.useMemo)(()=>{let e=(null==t?void 0:t.favoriteIds)||[];return e.includes(s)},[t,s]),u=(0,a.useCallback)(async e=>{if(e.stopPropagation(),!t)return i.onOpen();try{let e;e=d?()=>r.Z.delete("/api/favorites/".concat(s)):()=>r.Z.post("/api/favorites/".concat(s)),await e(),l.refresh(),n.Am.success("Success")}catch(e){n.Am.error("Something went wrong.")}},[t,d,s,i,l]);return{hasFavorited:d,toggleFavorite:u}},u=e=>{let{listingId:s,currentUser:t}=e,{hasFavorited:r,toggleFavorite:o}=d({listingId:s,currentUser:t});return(0,l.jsxs)("div",{onClick:o,className:"   relative   hover:opacity-80   transition   cursor-pointer   ",children:[(0,l.jsx)(i.lo,{size:28,className:"   fill-white   absolute   -top-[2px]   -right-[2px]   "}),(0,l.jsx)(i.M_L,{size:24,className:r?"fill-rose-500":"fill-neutral-500/70"})]})}},7952:function(e,s,t){"use strict";t.r(s);var l=t(1264),i=t(7005),r=t.n(i),o=t(7094),a=t(6141),n=t(1907),c=t(6378),d=t(2852);s.default=e=>{let{data:s,onAction:t,onEdit:i,disabled:u,actionLabel:x,actionId:p="",currentUser:m}=e,h=(0,o.useRouter)(),{getByValue:f}=(0,n.Z)(),g=f(s.locationValue),v=(0,a.useCallback)(e=>{e.stopPropagation(),u||null==t||t(p)},[u,t,p]),j=(0,a.useMemo)(()=>s.price,[,s.price]);return(0,l.jsx)("div",{onClick:()=>h.push("/listings/".concat(s.id)),className:"col-span-1 mt-10 cursor-pointer group",children:(0,l.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,l.jsxs)("div",{className:"   aspect-square    w-full    relative    overflow-hidden    rounded-xl   ",children:[(0,l.jsx)(r(),{fill:!0,className:"   object-cover    h-full    w-full    group-hover:scale-110    transition   ",src:s.imageSrc,alt:"Listing"}),(0,l.jsx)("div",{className:"   absolute   top-3   right-3   ",children:(0,l.jsx)(d.Z,{listingId:s.id,currentUser:m})})]}),(0,l.jsx)("div",{className:"font-semibold text-lg",children:s.title}),(0,l.jsxs)("div",{className:"font-semibold text-lg",children:[null==g?void 0:g.region,", ",null==g?void 0:g.label]}),(0,l.jsx)("div",{className:"flex flex-row items-center gap-1",children:(0,l.jsxs)("div",{className:"font-semibold",children:["$ ",j]})}),(0,l.jsx)("div",{className:"flex flex-row items-center justify-between mt-2",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[m&&m.id===s.userId&&i&&(0,l.jsxs)("button",{className:"flex items-center text-sm text-gray-500 hover:text-gray-700 cursor-pointer",onClick:e=>{e.stopPropagation(),i(s.id)},children:[(0,l.jsx)(c.fmQ,{}),(0,l.jsx)("span",{children:"Edit"})]}),t&&x&&(0,l.jsxs)("button",{className:"flex items-center text-sm text-red-500 hover:text-red-700 cursor-pointer",onClick:v,disabled:u,children:[(0,l.jsx)(c.Xm5,{}),(0,l.jsx)("span",{children:x})]})]})})]})})}},6852:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return I}});var l,i,r=t(1264),o=t(3451),a=t(5083),n=t(6141),c=t(7094),d=t(7288),u=t(7635),x=t(7952),p=t(5800),m=t(5077),h=t.n(m),f=t(5528),g=t(9592),v=t(5468),j=t(8632),b=t(4867),y=t(3574),N=t(4613),C=e=>{let{onClose:s}=e,[t,l]=(0,n.useState)(!1);return{isOpen:t,openModal:()=>{l(!0),console.log("Modal is open")},closeModal:()=>{l(!1),s()}}};(l=i||(i={}))[l.CATEGORY=0]="CATEGORY",l[l.LOCATION=1]="LOCATION",l[l.INFO=2]="INFO",l[l.IMAGES=3]="IMAGES",l[l.DESCRIPTION=4]="DESCRIPTION",l[l.PRICE=5]="PRICE";var w=e=>{let{listingId:s,onClose:l,isOpen:c}=e,{openModal:u,closeModal:x}=C({onClose:l}),[m,w]=(0,n.useState)(!1),[I,S]=(0,n.useState)(!1),[E,O]=(0,n.useState)(i.CATEGORY),{register:A,handleSubmit:P,setValue:k,watch:R,formState:{errors:Z}}=(0,p.cI)({defaultValues:{category:"",location:null,guestCount:1,roomCount:1,bathroomCount:1,imageSrc:"",price:1,title:"",description:""}}),M=R("category"),T=R("guestCount"),L=R("roomCount"),G=R("imageSrc"),_=R("location");(0,n.useEffect)(()=>{I&&(x(),S(!1))},[I,x]);let D=(e,s)=>{k(e,s,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0})},H=(0,n.useMemo)(()=>h()(()=>Promise.all([t.e(726),t.e(250)]).then(t.bind(t,7250)),{loadableGenerated:{webpack:()=>[7250]},ssr:!1}),[]),Y=()=>{O(e=>e+1)},q=(0,n.useMemo)(()=>E===i.PRICE?"Update":"Next",[E]),F=(0,n.useMemo)(()=>{if(E!==i.CATEGORY)return"Back"},[E]),U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"Which of these best describes your place?",subtitle:"Pick a category"}),(0,r.jsx)("div",{className:"   grid    grid-cols-1    md:grid-cols-2    gap-3   max-h-[50vh]   overflow-y-auto   ",children:j.b.map(e=>(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsx)(v.Z,{onClick:e=>D("category",e),selected:M===e.label,label:e.label,icon:e.icon})},e.label))})]});return E===i.LOCATION&&(U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"Where is your property located?",subtitle:"Help guests find your property!"}),(0,r.jsx)(N.Z,{value:_,onChange:e=>D("location",e)}),(0,r.jsx)(H,{center:null==_?void 0:_.latlng})]})),E===i.INFO&&(U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"Share some basics about your place",subtitle:"What amenities do you have?"}),(0,r.jsx)(g.Z,{onChange:e=>D("guestCount",e),value:T,title:"Guests",subtitle:"How many guests do you allow?"}),(0,r.jsx)("hr",{}),(0,r.jsx)(g.Z,{onChange:e=>D("roomCount",e),value:L,title:"Rooms",subtitle:"How many rooms do you have?"}),(0,r.jsx)("hr",{})]})),E===i.IMAGES&&(U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"Add a photo of your property",subtitle:"Show guests what your property looks like!"}),(0,r.jsx)(b.Z,{onChange:e=>D("imageSrc",e),value:G})]})),E===i.DESCRIPTION&&(U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"How would you describe your property?",subtitle:"Short and sweet works best!"}),(0,r.jsx)(y.Z,{id:"title",label:"Title",disabled:m,register:A,errors:Z,required:!0}),(0,r.jsx)("hr",{}),(0,r.jsx)(y.Z,{id:"description",label:"Description",disabled:m,register:A,errors:Z,required:!0})]})),E===i.PRICE&&(U=(0,r.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,r.jsx)(d.default,{title:"Now, set your price",subtitle:"How much do you charge per night?"}),(0,r.jsx)(y.Z,{id:"price",label:"Price",formatPrice:!0,type:"number",disabled:m,register:A,errors:Z,required:!0})]})),(0,r.jsx)(f.Z,{disabled:m,isOpen:c,title:"Edit your property!",actionLabel:q,onSubmit:P(e=>{if(E!==i.PRICE)return Y();e.price=parseInt(e.price),w(!0),a.Z.put("/api/listings/".concat(s),e).then(()=>{o.Am.success("Listing updated!"),S(!0)}).catch(()=>{o.Am.error("Something went wrong.")}).finally(()=>{w(!1)})}),secondaryActionLabel:F,secondaryAction:E===i.CATEGORY?void 0:()=>{O(e=>e-1)},onClose:x,body:U})},I=e=>{let{listings:s,currentUser:t}=e,l=(0,c.useRouter)(),[i,p]=(0,n.useState)(null),[m,h]=(0,n.useState)(""),{isOpen:f,openModal:g,closeModal:v}=C({onClose:()=>p(null)}),j=(0,n.useCallback)(e=>{h(e),a.Z.delete("/api/listings/".concat(e)).then(()=>{o.Am.success("Listing deleted"),l.refresh()}).catch(e=>{var s,t;o.Am.error(null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.error)}).finally(()=>{h("")})},[l]),b=e=>{p(e),g()};return(0,r.jsxs)(u.default,{children:[(0,r.jsx)(d.default,{title:"Properties",subtitle:"List of your properties"}),(0,r.jsx)("div",{className:"mt-10 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-8",children:s.map(e=>(0,r.jsx)(x.default,{data:e,actionId:e.id,onAction:j,onEdit:()=>b(e.id),disabled:m===e.id,actionLabel:"Delete",currentUser:t},e.id))}),(0,r.jsx)(w,{listingId:i||"",isOpen:f,closeModal:v,onClose:()=>p(null)})]})}}},function(e){e.O(0,[286,742,515,552,954,554,811,310,274,774,597,744],function(){return e(e.s=314)}),_N_E=e.O()}]);